<modification>
	<name>Facebook Pixel Conversions + Event Tracking</name>
    <author>opencarttools@gmail.com</author>
	<version>2.X - 3.X</version>
    <link>http://www.opencarttools.net</link>
	<code>34723</code>
	<file path="admin/controller/common/column_left.php">
        <operation error="skip">
            <search position="before"><![CDATA[$report = array();]]></search>
			<add position="before"><![CDATA[
			if($this->user->hasPermission('access', 'extension/fbecommevnt') && file_exists('model/extension/fbecommevnt.php')) { 
				$data['menus'][] = array(
					'id'       => 'menu-fbecommevnt',
					'icon'	   => 'fa-arrow-right', 
					'name'	   => 'Facebook Pixel Conversions + Event Tracking',
					'href'     => $this->url->link('extension/fbecommevnt', 'user_token=' . $this->session->data['user_token'], true),
					'children' => array()
				);	
			}]]></add> 
        </operation>
  	</file>
	<file path="catalog/controller/common/header.php">
		<operation error="skip">
            <search position="after"><![CDATA[function index]]></search>
            <add position="after"><![CDATA[$data['fbecommevnt_gettrackcode'] = '';
			if(file_exists('catalog/model/extension/fbecommevnt.php')) { 
				$this->load->model('extension/fbecommevnt');
				$this->document->addScript('catalog/view/javascript/fbecommevnt.js');
				$data['fbecommevnt_gettrackcode'] = $this->model_extension_fbecommevnt->gettrackcode();
			}]]></add> 
        </operation>
    </file>
	<file path="catalog/view/theme/*/template/common/header.twig">
		<operation error="skip">
			<search position="before"><![CDATA[</head>]]></search>
			<add position="before"><![CDATA[{{ fbecommevnt_gettrackcode }}]]></add>
		</operation>
	</file>
	<file path="catalog/controller/product/product.php">
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(file_exists('catalog/model/extension/fbecommevntprodpage.php')) { 
				$this->load->model('extension/fbecommevntprodpage');
				$data['footer'] .= $this->model_extension_fbecommevntprodpage->getcode(isset($this->request->get['product_id']) ? $this->request->get['product_id'] : 0);
			}]]></add>
        </operation> 
    </file>
	<file path="catalog/controller/product/search.php">
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(file_exists('catalog/model/extension/fbecommevntsearchprod.php')) { 
				$this->load->model('extension/fbecommevntsearchprod');
				$data['footer'] .= $this->model_extension_fbecommevntsearchprod->getcode(isset($this->request->get['search']) ? $this->request->get['search'] : '');
			}]]></add>
        </operation> 
    </file>
	<file path="catalog/controller/information/contact.php">
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(file_exists('catalog/model/extension/fbecommevntcontact.php')) { 
				$this->load->model('extension/fbecommevntcontact');
				$data['footer'] .= $this->model_extension_fbecommevntcontact->getcode();
			}]]></add>
        </operation> 
    </file>
	<file path="catalog/controller/account/login.php">
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(file_exists('catalog/model/extension/fbecommevntlogreg.php')) { 
				$this->load->model('extension/fbecommevntlogreg');
				$data['footer'] .= $this->model_extension_fbecommevntlogreg->getcode(1);
			}]]></add>
        </operation> 
    </file>
	<file path="catalog/controller/account/register.php">
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(file_exists('catalog/model/extension/fbecommevntlogreg.php')) { 
				$this->load->model('extension/fbecommevntlogreg');
				$data['footer'] .= $this->model_extension_fbecommevntlogreg->getcode(2);
			}]]></add>
        </operation> 
    </file>
	<file path="catalog/controller/checkout/checkout.php">
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(file_exists('catalog/model/extension/fbecommevntchkbeg.php')) { 
				$this->load->model('extension/fbecommevntchkbeg');
				$data['footer'] .= $this->model_extension_fbecommevntchkbeg->getcode();
			}]]></add>
        </operation> 
    </file>	
	<file path="catalog/controller/mail/order.php">
        <operation error="skip">
            <search position="after"><![CDATA[function add]]></search>
            <add position="after"><![CDATA[$this->session->data['fbecommevnt_order_id'] = $order_info['order_id'];]]></add>
        </operation>
    </file>
	<file path="catalog/model/checkout/order.php">
        <operation error="skip">
            <search position="after"><![CDATA[$order_id = $this->db->getLastId();]]></search>
            <add position="after"><![CDATA[$this->session->data['fbecommevnt_order_id'] = $order_id;]]></add>
        </operation>
    </file>
	<file path="catalog/controller/checkout/success.php">
        <operation error="skip">
            <search position="after"><![CDATA[function index]]></search>
            <add position="after"><![CDATA[$data['fbecommevntchksuccess_code'] = '';
			if(file_exists('catalog/model/extension/fbecommevntchksuccess.php')) {
				$this->load->model('extension/fbecommevntchksuccess');
				$data['fbecommevntchksuccess_code'] = $this->model_extension_fbecommevntchksuccess->getcode(!empty($this->session->data['order_id']) ? $this->session->data['order_id'] : 0);
			}]]></add>
        </operation>
		<operation error="skip">
            <search position="after"><![CDATA[$data['footer'] =]]></search>
            <add position="after"><![CDATA[if(!empty($data['fbecommevntchksuccess_code'])) {
				$data['footer'] .= $data['fbecommevntchksuccess_code'];
			}]]></add>
        </operation> 
    </file>
</modification>